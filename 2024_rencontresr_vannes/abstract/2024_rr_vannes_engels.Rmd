---
title: "Des tableaux et des graphiques prêts à publication avec les packages R {tabularise} et {chart} de la suite SciViews"
author:
- Guyliann Engels 1^[Service d'écologie numérique, Institut Complexys & Infortech, Université de Mons, Belgique, guyliann.engels@umons.ac.be]
- Philippe Grosjean 2^[Service d'écologie numérique, Institut Complexys & Infortech, Université de Mons, Belgique, philippe.grosjean@umons.ac.be]
output: 
  pdf_document: 
    latex_engine: xelatex
indent: true
bibliography: ref.bib
---

```{=tex}
\begin{center}
\textbf{Résumé (max 300 mots)}
\end{center}
```
Dans l’univers de R, plusieurs packages tels que {flextable} [@flextable], {gt} [@gt] ou encore {stargazer} [@stargazer] offrent des fonctionnalités de formatage de tableaux pour répondre aux normes de qualité des revues scientifiques. Bien que ces packages nécessitent de nombreuses lignes de code pour atteindre ces normes, ils permettent une personnalisation complète des tableaux. Cette situation est comparable à celle des packages dédiés à la génération de graphiques. Les graphiques sont réalisables avec les packages {graphics} [@graphics], {lattice} [@lattice] ou encore {ggplot2} [@ggplot]. Les possibilités de personnalisation sont également nombreuses.

Au sein de la suite de packages SciViews [@sciviews]qui contient par exemple {[data.io](https://www.sciviews.org/data.io/)}, {[svFlow](https://www.sciviews.org/svFlow/)}, ou encore {[learnitdown](https://www.sciviews.org/learnitdown/)}, nous présentons {[tabularise](https://www.sciviews.org/tabularise)} pour les tableaux et {[chart](https://www.sciviews.org/chart/)} pour les graphiques. Ces outils s’appuient respectivement sur {flextable} et {ggplot2} pour offrir des tableaux et des graphiques représentant différents objets R, tels que **lm** ou **glm**, par exemple.

Ces tableaux et graphiques supportent l'anglais et le français et prennent également en compte les labels des variables pour fournir du contenu prêt à être publié avec un minimum d’instructions R. Ces outils visent à simplifier et à accélérer le processus de préparation des contenus à la publication.

\noindent \textbf{Mots-clefs} : Prêt à publication -- Tableau -- Graphique -- tabularise -- chart -- SciViews

## Développement

Lors de la rédaction de documents scientifiques, d’articles de blog ou encore de manuscrits de thèse, des outils tels que Rmarkdown [@rmarkdown] ou Quarto [@quarto] sont couramment utilisés. Ces outils permettent d’intégrer du code R dans des chunks et du texte en Markdown, ce qui constitue la première étape pour produire des documents prêts à être publiés. Cependant, une seconde étape est nécessaire pour créer des tableaux et des graphiques conformes aux normes de publication. Les sorties de base de R ne sont pas adaptées à cette fin, mais la communauté R propose de nombreuses solutions parmi les plus de 20 000 packages disponibles sur CRAN, sans compter ceux disponibles depuis BioConductor, GitHub ou Gitlab.

Pour la création de tableaux adaptés à la publication, on peut citer le package R {flextable} [@flextable] ou encore le package {gt} [@gt]. Ces outils puissants permettent de formater un tableau à partir d’un data frame. Ils offrent une grande flexibilité pour répondre à tous les besoins, mais nécessitent de nombreuses lignes de code pour obtenir le tableau dans le formatage souhaité. C’est pourquoi nous proposons, dans le cadre de SciViews, le package {tabularise}. Ce package permet d’obtenir des tableaux prêts à être publiés en une seule instruction pour une série d'objets dans R. Ces premières versions peuvent ensuite être remaniées à l'aide des instructions de {flextable}. {tabularise} gère l’anglais et le français et prend en compte automatiquement les labels des variables si ils sont présents dans l'objet. De nombreuses méthodes sont disponibles. Certaines offrent des fonctionnalités supplémentaires au-delà de réalisation de tableaux. Par exemple, pour les objets **lm**, {tabularise} intègre également des équations dans son rendu en s'appuyant sur le package {equatiomatic} [@equatiomatic]. Ces caractéristiques en font un package intéressant pour la recherche et l’enseignement.

```{r setup, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, echo=TRUE, message=FALSE)
# Configuration de l'environnement de travail avec SciViews
SciViews::R("model", lang = "fr") 
# Charge plusieurs packages dont chart et tabularise
# Charge des packages supplémentaires pour la modélisation
# Spécifie que l'on souhaite les sorties au maximum en français
```

Prenons un cas pratique avec l'utilisation du tableau de données bien connu `penguins` du package {palmerpenguins}. Le tableau suivant présente les premières et dernières lignes des données.

```{r}
penguins <- read("penguins", package = "palmerpenguins") 
tabularise(penguins[1:5,1:4])
```

Une régression linéaire peut être réalisée afin d'étudier la variation de la longueur du bec en fonction de la largeur du bec et de l'espèce étudiée. Ce modèle peut être résumé par la fonction summary() ou encore mis sous forme de tableau avec la fonction tidy() du package {broom}. Ces deux sorties, bien que riches en informations, nécessitent d'être formatées pour figurer dans un rapport d'analyse.La solution proposée avec la fonction tabularise() permet d'obtenir un rendu plus abouti, comme le montrent les deux tableaux suivants, tout en respectant la classe des objets.

```{r}
peng_model <- lm(data = penguins, bill_length ~ bill_depth + species)
```

Les solutions proposées avec la fonction tabularise() permettent d'obtenir un rendu plus abouti, comme le montrent les deux tableaux suivants, tout en respectant la classe des objets.

```{r}
summary(peng_model)
summary(peng_model) |> tabularise()
```

```{r}
tidy(peng_model)
tabularise(peng_model, type = "tidy")
```

Vous retrouvez plusieurs autres exemples d'utilisation dans l'enseignement dans les modules relatif à la [régression linéaire](https://wp.sciviews.org/sdd-umons2/?iframe=wp.sciviews.org/sdd-umons2-2023/outils-de-diagnostic-suite.html) des cours de Sciences des données biologique données à l'Université de Mons.

Vous retrouvez plusieurs autres exemples d'utilisation dans l'enseignement dans les modules relatifs à la [régression linéaire](https://wp.sciviews.org/sdd-umons2/?iframe=wp.sciviews.org/sdd-umons2-2023/outils-de-diagnostic-suite.html) des cours de sciences des données biologiques donnés à l'Université de Mons.

En ce qui concerne les graphiques, la communauté R propose principalement trois solutions : les packages R {graphics} [@graphics], {lattice} [@lattice] et {ggplot2} [@ggplot]. Le package {chart} propose une interface unique pour unifier ces trois moteurs graphiques, mais s'appuie principalement sur {ggplot2}. L’interface formule est utilisée, ce qui permet de se rapprocher des instructions que l’on peut utiliser, par exemple, dans la fonction `lm()`. Tout comme {tabularise}, {chart} s’adapte à l’anglais et au français. Il utilise les labels et les unités des variables pour libeller automatiquement les axes du graphique. De nombreuses méthodes ont été développées pour fournir des graphiques adaptés à toute une série d’objets.

En reprenant l'exemple réalisé ci-dessus, on peut le visualiser sous la forme d'un nuage de points avec les instructions suivantes. L'interface formule permet, entre autres, d'obtenir une haute ressemblance avec la formule proposée par la fonction lm().

```{r}
chart(data = penguins, bill_length ~ bill_depth %col=% species) +
  geom_point()
```

Tout comme tabularise, chart() propose des graphiques spécifiques lors de l'utilisation de certains objets dans R.

```{r}
chart(peng_model, type = "qqplot")
```

Nous utilisons le package {chart} pour la grande majorité des graphiques que nous réalisons dans les 34 modules des cours de [sciences des données biologiques](https://wp.sciviews.org/) de l'Université de Mons.

En conclusion, {tabularise} et {chart} sont deux packages développés dans le cadre de SciViews pour faciliter et améliorer les sorties tabulaires et graphiques de R, prêts à être publiés.

## Références
